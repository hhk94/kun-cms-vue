{"remainingRequest":"D:\\code_by_hk\\kun-cms-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\code_by_hk\\kun-cms-vue\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\code_by_hk\\kun-cms-vue\\src\\kun\\utils\\storage.js","dependencies":[{"path":"D:\\code_by_hk\\kun-cms-vue\\src\\kun\\utils\\storage.js","mtime":1586922598763},{"path":"D:\\code_by_hk\\kun-cms-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code_by_hk\\kun-cms-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\code_by_hk\\kun-cms-vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkQ6XFxjb2RlX2J5X2hrXFxrdW4tY21zLXZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkQ6XFxjb2RlX2J5X2hrXFxrdW4tY21zLXZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwoKLy/mnKzlnLDnvJPlrZjln7rnsbsKdmFyIFN0b3JhZ2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN0b3JhZ2UoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RvcmFnZSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU3RvcmFnZSwgW3sKICAgIGtleTogInNldF9zdG9yYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRfc3RvcmFnZShwYXJhbXMpIHsKICAgICAgdmFyIG9iaiA9IHsKICAgICAgICBuYW1lOiAnJywKICAgICAgICB2YWx1ZTogJycsCiAgICAgICAgZXhwaXJlczogIiIsCiAgICAgICAgLy/ov4fmnJ/ml7bpl7QKICAgICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8v6K6w5b2V5L2V5pe25bCG5YC85a2Y5YWl57yT5a2Y77yM5q+r56eS57qnCgogICAgICB9OwogICAgICB2YXIgb3B0aW9ucyA9IHt9OwogICAgICBPYmplY3QuYXNzaWduKG9wdGlvbnMsIG9iaiwgcGFyYW1zKTsgLy/lsIZvYmrlkozkvKDov5vmnaXnmoRwYXJhbXPlkIjlubYKCiAgICAgIGlmIChvcHRpb25zLmV4cGlyZXMpIHsKICAgICAgICAvL+WmguaenG9wdGlvbnMuZXhwaXJlc+iuvue9ruS6hueahOivnQogICAgICAgIC8v5Lulb3B0aW9ucy5uYW1l5Li6a2V577yMb3B0aW9uc+S4uuWAvOaUvui/m+WOuwogICAgICAgIHRyeSB7CiAgICAgICAgICAvLyB1bmkuc2V0U3RvcmFnZVN5bmMob3B0aW9ucy5uYW1lLEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKTsKICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKG9wdGlvbnMubmFtZSwgSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsvLyBlcnJvcgogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL+WmguaenG9wdGlvbnMuZXhwaXJlc+ayoeacieiuvue9ru+8jOWwseWIpOaWreS4gOS4i3ZhbHVl55qE57G75Z6LCiAgICAgICAgdmFyIHR5cGUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob3B0aW9ucy52YWx1ZSk7IC8v5aaC5p6cdmFsdWXmmK/lr7nosaHmiJbogIXmlbDnu4Tlr7nosaHnmoTnsbvlnovvvIzlsLHlhYjnlKhKU09OLnN0cmluZ2lmeei9rOS4gOS4i++8jOWGjeWtmOi/m+WOuwoKICAgICAgICBpZiAodHlwZSA9PSAnW29iamVjdCBPYmplY3RdJykgewogICAgICAgICAgb3B0aW9ucy52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMudmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGUgPT0gJ1tvYmplY3QgQXJyYXldJykgewogICAgICAgICAgb3B0aW9ucy52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMudmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIHVuaS5zZXRTdG9yYWdlU3luYyhvcHRpb25zLm5hbWUsb3B0aW9ucy52YWx1ZSk7CiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShvcHRpb25zLm5hbWUsIG9wdGlvbnMudmFsdWUpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsvLyBlcnJvcgogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldF9zdG9yYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRfc3RvcmFnZShuYW1lKSB7CiAgICAgIC8v5bCd6K+V6I635Y+W5pys5Zyw57yT5a2YCiAgICAgIHZhciBpdGVtOwoKICAgICAgdHJ5IHsKICAgICAgICAvLyBpdGVtID0gdW5pLmdldFN0b3JhZ2VTeW5jKG5hbWUpbmFtZQogICAgICAgIGl0ZW0gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShuYW1lKTsKICAgICAgfSBjYXRjaCAoZSkge30gLy9UT0RPIGhhbmRsZSB0aGUgZXhjZXB0aW9uCiAgICAgIC8v5YWI5bCG5ou/5Yiw55qE6K+V552A6L+b6KGManNvbui9rOS4uuWvueixoeeahOW9ouW8jwoKCiAgICAgIHRyeSB7CiAgICAgICAgLy/kvJrov4fmnJ8KICAgICAgICBpdGVtID0gSlNPTi5wYXJzZShpdGVtKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsvL+S4jeS8mui/h+acnwogICAgICAgIC8v5aaC5p6c5LiN6KGM5bCx5LiN5pivanNvbueahOWtl+espuS4su+8jOWwseebtOaOpei/lOWbngogICAgICAgIC8vIGl0ZW0gPSBpdGVtOwkKICAgICAgfQoKICAgICAgaWYgKCFpdGVtKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIGNvbnNvbGUubG9nKGl0ZW0pCiAgICAgIC8v5aaC5p6c5pyJc3RhcnRUaW1l55qE5YC877yM6K+05piO6K6+572u5LqG5aSx5pWI5pe26Ze0CiAgICAgIC8vIGNvbnNvbGUubG9nKGl0ZW0pCgoKICAgICAgaWYgKGl0ZW0uc3RhcnRUaW1lKSB7CiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgLy/lj5blh7rml7bpl7Qg5YeP5Y67IOWtmOWFpeaXtumXtO+8jOS4jml0ZW0uZXhwaXJlc+avlOi+g++8jOWkp+S6ji3ov4fmnJ8v5bCP5LqO562J5LqOLeayoei/h+acnwoKICAgICAgICBpZiAoZGF0ZSAtIGl0ZW0uc3RhcnRUaW1lID4gaXRlbS5leHBpcmVzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygndG9rZW7lpLHmlYgnKTsgLy/nvJPlrZjov4fmnJ/vvIzmuIXpmaTnvJPlrZjvvIzov5Tlm55mYWxzZQoKICAgICAgICAgIHRoaXMucmVtb3ZlX3N0b3JhZ2UobmFtZSk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8v57yT5a2Y5pyq6L+H5pyf77yM6L+U5Zue5YC8CiAgICAgICAgICByZXR1cm4gaXRlbS52YWx1ZTsgLy8gcmV0dXJuIGl0ZW07CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBpdGVtOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVtb3ZlX3N0b3JhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZV9zdG9yYWdlKG5hbWUpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyB1bmkucmVtb3ZlU3RvcmFnZVN5bmMobmFtZSk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0obmFtZSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsvLyBlcnJvcgogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xlYXJfc3RvcmFnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXJfc3RvcmFnZSgpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyB1bmkuY2xlYXJTdG9yYWdlU3luYygpOwogICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogICAgICB9IGNhdGNoIChlKSB7Ly8gZXJyb3IKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIFN0b3JhZ2U7Cn0oKTsKCmV4cG9ydCB7IFN0b3JhZ2UgfTs="},{"version":3,"sources":["D:/code_by_hk/kun-cms-vue/src/kun/utils/storage.js"],"names":["Storage","params","obj","name","value","expires","startTime","Date","getTime","options","Object","assign","localStorage","setItem","JSON","stringify","e","type","prototype","toString","call","item","getItem","parse","error","date","console","log","remove_storage","removeItem","clear"],"mappings":";;;;;AAAA;IACMA,O;AACL,qBAAc;AAAA;AAEb;;;;gCACUC,M,EAAO;AAClB,UAAIC,GAAG,GAAG;AACTC,QAAAA,IAAI,EAAC,EADI;AAETC,QAAAA,KAAK,EAAC,EAFG;AAGTC,QAAAA,OAAO,EAAC,EAHC;AAGE;AACXC,QAAAA,SAAS,EAAC,IAAIC,IAAJ,GAAWC,OAAX,EAJD,CAIqB;;AAJrB,OAAV;AAMA,UAAIC,OAAO,GAAG,EAAd;AACAC,MAAAA,MAAM,CAACC,MAAP,CAAcF,OAAd,EAAsBP,GAAtB,EAA0BD,MAA1B,EARkB,CAQgB;;AAClC,UAAGQ,OAAO,CAACJ,OAAX,EAAmB;AAClB;AACA;AACA,YAAI;AACH;AACAO,UAAAA,YAAY,CAACC,OAAb,CAAqBJ,OAAO,CAACN,IAA7B,EAAkCW,IAAI,CAACC,SAAL,CAAeN,OAAf,CAAlC;AACA,SAHD,CAGE,OAAOO,CAAP,EAAU,CACX;AACA;AACD,OATD,MASK;AACJ;AACA,YAAIC,IAAI,GAAGP,MAAM,CAACQ,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BX,OAAO,CAACL,KAAvC,CAAX,CAFI,CAGJ;;AACA,YAAGa,IAAI,IAAI,iBAAX,EAA6B;AAC5BR,UAAAA,OAAO,CAACL,KAAR,GAAgBU,IAAI,CAACC,SAAL,CAAeN,OAAO,CAACL,KAAvB,CAAhB;AACA;;AACD,YAAGa,IAAI,IAAI,gBAAX,EAA4B;AAC3BR,UAAAA,OAAO,CAACL,KAAR,GAAgBU,IAAI,CAACC,SAAL,CAAeN,OAAO,CAACL,KAAvB,CAAhB;AACA;;AACD,YAAI;AACH;AACAQ,UAAAA,YAAY,CAACC,OAAb,CAAqBJ,OAAO,CAACN,IAA7B,EAAkCM,OAAO,CAACL,KAA1C;AACA,SAHD,CAGE,OAAOY,CAAP,EAAU,CACX;AACA;AACD;AACD;;;gCACWb,I,EAAK;AAChB;AACA,UAAIkB,IAAJ;;AACA,UAAG;AACF;AACAA,QAAAA,IAAI,GAAGT,YAAY,CAACU,OAAb,CAAqBnB,IAArB,CAAP;AACA,OAHD,CAGC,OAAMa,CAAN,EAAQ,CAER,CAFA,CACA;AAED;;;AACA,UAAG;AACF;AACAK,QAAAA,IAAI,GAAGP,IAAI,CAACS,KAAL,CAAWF,IAAX,CAAP;AACA,OAHD,CAGC,OAAMG,KAAN,EAAY,CACZ;AACD;AACC;AACA;;AACD,UAAG,CAACH,IAAJ,EAAS;AACR;AACA,OApBe,CAqBhB;AACA;AACA;;;AACA,UAAGA,IAAI,CAACf,SAAR,EAAkB;AACjB,YAAImB,IAAI,GAAG,IAAIlB,IAAJ,GAAWC,OAAX,EAAX,CADiB,CAEjB;;AACA,YAAGiB,IAAI,GAAGJ,IAAI,CAACf,SAAZ,GAAwBe,IAAI,CAAChB,OAAhC,EAAwC;AACvCqB,UAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EADuC,CAEvC;;AACA,eAAKC,cAAL,CAAoBzB,IAApB;AACA,iBAAO,KAAP;AACA,SALD,MAKK;AACL;AACC,iBAAOkB,IAAI,CAACjB,KAAZ,CAFI,CAGJ;AACA;AACD,OAbD,MAaK;AACJ,eAAOiB,IAAP;AACA;AAED;;;mCACclB,I,EAAK;AACnB,UAAI;AACH;AACAS,QAAAA,YAAY,CAACiB,UAAb,CAAwB1B,IAAxB;AACA,OAHD,CAGE,OAAOa,CAAP,EAAU,CACX;AACA;AACD;;;oCACc;AACd,UAAI;AACH;AACAJ,QAAAA,YAAY,CAACkB,KAAb;AACA,OAHD,CAGE,OAAOd,CAAP,EAAU,CACX;AACA;AACD;;;;;;AAGD,SAAShB,OAAT","sourcesContent":["//本地缓存基类\r\nclass Storage {\r\n\tconstructor() {\r\n\t\t\r\n\t}\r\nset_storage(params){\r\n\tlet obj = {\r\n\t\tname:'',\r\n\t\tvalue:'',\r\n\t\texpires:\"\",//过期时间\r\n\t\tstartTime:new Date().getTime()//记录何时将值存入缓存，毫秒级\r\n\t}\r\n\tlet options = {};\r\n\tObject.assign(options,obj,params);//将obj和传进来的params合并\r\n\tif(options.expires){\r\n\t\t//如果options.expires设置了的话\r\n\t\t//以options.name为key，options为值放进去\r\n\t\ttry {\r\n\t\t\t// uni.setStorageSync(options.name,JSON.stringify(options));\r\n\t\t\tlocalStorage.setItem(options.name,JSON.stringify(options))\r\n\t\t} catch (e) {\r\n\t\t\t// error\r\n\t\t}\r\n\t}else{\r\n\t\t//如果options.expires没有设置，就判断一下value的类型\r\n\t\tlet type = Object.prototype.toString.call(options.value);\r\n\t\t//如果value是对象或者数组对象的类型，就先用JSON.stringify转一下，再存进去\r\n\t\tif(type == '[object Object]'){\r\n\t\t\toptions.value = JSON.stringify(options.value);\r\n\t\t}\r\n\t\tif(type == '[object Array]'){\r\n\t\t\toptions.value = JSON.stringify(options.value);\r\n\t\t}\r\n\t\ttry {\r\n\t\t\t// uni.setStorageSync(options.name,options.value);\r\n\t\t\tlocalStorage.setItem(options.name,options.value)\r\n\t\t} catch (e) {\r\n\t\t\t// error\r\n\t\t}\r\n\t}\r\n}\r\nget_storage(name){\r\n\t//尝试获取本地缓存\r\n\tlet item\r\n\ttry{\r\n\t\t// item = uni.getStorageSync(name)name\r\n\t\titem = localStorage.getItem(name);\r\n\t}catch(e){\r\n\t\t//TODO handle the exception\r\n\t}\r\n\t//先将拿到的试着进行json转为对象的形式\r\n\ttry{\r\n\t\t//会过期\r\n\t\titem = JSON.parse(item);\r\n\t}catch(error){\r\n\t\t//不会过期\r\n\t//如果不行就不是json的字符串，就直接返回\r\n\t\t// item = item;\t\r\n\t}\r\n\tif(!item){\r\n\t\treturn;\r\n\t}\r\n\t// console.log(item)\r\n\t//如果有startTime的值，说明设置了失效时间\r\n\t// console.log(item)\r\n\tif(item.startTime){\r\n\t\tlet date = new Date().getTime();\r\n\t\t//取出时间 减去 存入时间，与item.expires比较，大于-过期/小于等于-没过期\r\n\t\tif(date - item.startTime > item.expires){\r\n\t\t\tconsole.log('token失效')\r\n\t\t\t//缓存过期，清除缓存，返回false\r\n\t\t\tthis.remove_storage(name);\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t//缓存未过期，返回值\r\n\t\t\treturn item.value;\r\n\t\t\t// return item;\r\n\t\t}\r\n\t}else{\r\n\t\treturn item;\r\n\t}\r\n\r\n}\r\nremove_storage(name){\r\n\ttry {\r\n\t\t// uni.removeStorageSync(name);\r\n\t\tlocalStorage.removeItem(name);\r\n\t} catch (e) {\r\n\t\t// error\r\n\t}\r\n}\r\nclear_storage(){\r\n\ttry {\r\n\t\t// uni.clearStorageSync();\r\n\t\tlocalStorage.clear();\r\n\t} catch (e) {\r\n\t\t// error\r\n\t}\r\n}\r\n}\r\n\r\nexport { Storage }"]}]}